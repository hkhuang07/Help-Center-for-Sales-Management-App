<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" type="text/css" href="./style.css" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet" />
	<link rel="stylesheet" href="./style.css" />
    <title>Orders - HK.Huang Sales Management Software Guide</title>

    <style>
        /* Custom CSS for the guide page */
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f8f9fa;
        }

        .container {
            max-width: 960px;
            margin-top: 20px;
            margin-bottom: 20px;
        }

        .card-header {
            background-color: #007bff;
            color: white;
            font-size: 1.5rem;
            font-weight: bold;
        }

        .card-body h2,
        .card-body h3 {
            color: #0056b3;
            margin-top: 25px;
            margin-bottom: 15px;
        }

        .card-body ul {
            margin-bottom: 15px;
        }

        .card-body ul li {
            margin-bottom: 8px;
        }

        .card-body strong {
            color: #343a40;
        }

        .img-fluid {
            border: 1px solid #ddd;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .alert-info {
            background-color: #e0f2f7;
            border-color: #bee5eb;
            color: #0c5460;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
        }

        .alert-warning {
            background-color: #fff3cd;
            border-color: #ffeeba;
            color: #664d03;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
        }

        .alert-danger {
            background-color: #f8d7da;
            border-color: #f5c2c7;
            color: #842029;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
        }

        .note {
            font-style: italic;
            color: #6c757d;
            margin-top: 10px;
        }

        .highlight {
            background-color: #fff3cd;
            padding: 2px 5px;
            border-radius: 3px;
        }
    </style>
</head>

<body>
    <div class="container">
        <div id="navbar"></div>

        <div class="card mt-3">
            <div class="card-header">
                <i class="bi bi-cart-fill me-2"></i>Orders Management User Guide
            </div>
            <div class="card-body">
                <p class="card-text">This guide provides comprehensive instructions for managing sales orders within the **HK.Huang Sales Management Software**. This includes viewing, creating, updating, deleting, searching, printing, and exporting orders, as well as managing order details.</p>

                <h2 class="mt-4"><i class="bi bi-layout-text-sidebar-reverse me-2"></i>Overview of the Orders Screen</h2>
                <p>The main Orders management screen (<span class="highlight">frmOrders</span>) provides an overview of all sales orders. Here you can:</p>
                <ul>
                    <li><strong>Order List (Data Grid View):</strong> Displays all sales orders with key information such as Order ID, Date, Employee Name, Customer Name, Total Price, and Notes.</li>
                    <li><strong>Action Buttons:</strong> Buttons to create new orders, update existing ones, delete, print, and export data.</li>
                    <li><strong>Navigation and Search Bar:</strong> Tools to navigate through the list and find specific orders.</li>
                </ul>
                <img src="images/orders.png" class="img-fluid mx-auto d-block" alt="Screenshot of the Orders management screen" />
                <p class="note text-center">Image: The main interface for managing orders.</p>

                <h3 class="mt-4"><i class="bi bi-list-ol me-2"></i>Viewing and Navigating Orders</h3>
                <p>Upon opening the Orders screen (<span class="highlight">frmOrders_Load</span>), all sales order records are automatically loaded into the data grid view.</p>
                <ul>
                    <li><strong>Navigation Buttons:</strong> Use <strong class="text-primary">First (<span class="highlight">btnBegin</span>)</strong>, <strong class="text-primary">Previous (<span class="highlight">btnPrevious</span>)</strong>, <strong class="text-primary">Next (<span class="highlight">btnNext</span>)</strong>, and <strong class="text-primary">Last (<span class="highlight">btnEnd</span>)</strong> to move through the order list.</li>
                    <li><strong>Search Functionality:</strong>
                        <ul>
                            <li>Enter keywords into the search box (<span class="highlight">txtFind</span>).</li>
                            <li>The list will automatically filter by Customer Name, Order Date, Employee Name, Note, or Total Price as you type (triggered by <span class="highlight">txtFind.TextChanged</span>).</li>
                            <li>If no matches are found, a "No matching order found." message will appear (in <span class="highlight">lblMessage</span>).</li>
                            <li>Click the <strong class="text-secondary">Clear</strong> button (<span class="highlight">btnClear_Click</span>) to remove the filter and show all orders.</li>
                        </ul>
                    </li>
                </ul>

                <h3 class="mt-4"><i class="bi bi-plus-circle-fill me-2"></i>Creating a New Order</h3>
                <p>To create a new sales order:</p>
                <ol>
                    <li>Click the <strong class="text-success">Create</strong> button (<span class="highlight">btnCreate_Click</span>). This will open the <a href="#order-details-screen">Order Details screen</a> (<span class="highlight">frmOrderDetails</span>) for a new entry.</li>
                    <li>On the Order Details screen, select the Employee and Customer, and add the products to the order.</li>
                    <li>Click <strong class="text-primary">Save</strong> on the Order Details screen to finalize the new order. The Order screen will then refresh to show the newly added order.</li>
                </ol>

                <h3 class="mt-4"><i class="bi bi-pencil-square me-2"></i>Updating an Existing Order</h3>
                <p>To modify an existing sales order:</p>
                <ol>
                    <li>Select the order you wish to update from the data grid view.</li>
                    <li>Click the <strong class="text-warning">Update</strong> button (<span class="highlight">btnUpdate_Click</span>) or click the <strong class="text-info">View Details</strong> link/button in the last column of the order's row (<span class="highlight">dataGridView_CellContentClick</span>). Both actions will open the <a href="#order-details-screen">Order Details screen</a> (<span class="highlight">frmOrderDetails</span>) pre-populated with the selected order's information.</li>
                    <li>Make the necessary changes to the order details (e.g., add/remove products, change quantity/price, update note, customer, or employee).</li>
                    <li>Click <strong class="text-primary">Save</strong> on the Order Details screen to apply your changes. The main Orders screen will then refresh.</li>
                </ol>

                <h3 class="mt-4"><i class="bi bi-trash-fill me-2"></i>Deleting an Order</h3>
                <p>To remove an order record:</p>
                <ol>
                    <li>Select the order you wish to delete from the data grid view.</li>
                    <li>Click the <strong class="text-danger">Delete</strong> button (<span class="highlight">bntDelete_Click</span>).</li>
                    <li>A confirmation message "Are you sure you want to delete this order?" will appear. Click <strong class="text-success">Yes</strong> to proceed or <strong class="text-danger">No</strong> to cancel.</li>
                    <li>If confirmed, an "Order deleted successfully!" message will appear, and the order will be removed from the list.</li>
                </ol>
                <div class="alert alert-danger" role="alert">
                    <i class="bi bi-exclamation-triangle-fill me-2"></i> <strong>Warning:</strong> Deleting an order will permanently remove it and its associated details from the system.
                </div>

                <h3 class="mt-4"><i class="bi bi-printer-fill me-2"></i>Printing an Order (Opening Print Preview)</h3>
                <p>To print an order invoice or preview it before printing:</p>
                <ol>
                    <li>Select the order you wish to print from the data grid view.</li>
                    <li>Click the <strong class="text-info">Print</strong> button (<span class="highlight">btnPrint_Click</span>). This will open the <a href="#print-order-screen">Print Order screen</a> (<span class="highlight">frmPrintOrder</span>), showing a printable preview of the selected order.</li>
                </ol>

                <h3 class="mt-4"><i class="bi bi-file-earmark-arrow-up-fill me-2"></i>Exporting Orders to Excel</h3>
                <p>You can export the current list of orders to an Excel file:</p>
                <ol>
                    <li>Click the <strong class="text-info">Export</strong> button (<span class="highlight">btnExport_Click</span>). A "Save File" dialog will appear.</li>
                    <li>Choose a location and enter a file name for your Excel file (e.g., <span class="highlight">Orders_YYYY_MM_DD.xlsx</span>).</li>
                    <li>Click <strong class="text-primary">Save</strong>.</li>
                    <li>A "Exported data to Excel file successfully!" message will confirm the export. The Excel file will contain columns for ID, Date, Employee Name, Customer Name, Total Price, Note, and View Details.</li>
                </ol>

                <h2 id="order-details-screen" class="mt-5"><i class="bi bi-clipboard-check-fill me-2"></i>Order Details Screen</h2>
                <p>The Order Details screen (<span class="highlight">frmOrderDetails</span>) is used to specify the items included in an order, along with customer and employee information. This screen is accessed when creating a new order or updating an existing one.</p>
                <img src="images/orderdetails.png" class="img-fluid mx-auto d-block" alt="Screenshot of the Order Details screen" />
                <p class="note text-center">Image: The interface for managing individual order details.</p>

                <h3>1. Order Header Information</h3>
                <ul>
                    <li><strong>Employee (<span class="highlight">cboEmployee</span>):</strong> Select the employee responsible for this order.</li>
                    <li><strong>Customer (<span class="highlight">cboCustomer</span>):</strong> Select the customer for this order.</li>
                    <li><strong>Note (<span class="highlight">txtNote</span>):</strong> Add any relevant notes for the order.</li>
                </ul>

                <h3>2. Adding/Updating Order Items (Products)</h3>
                <p>To manage products within an order:</p>
                <ol>
                    <li><strong>Select Product:</strong> Choose a product from the "Product" dropdown (<span class="highlight">cboProduct</span>). The "Price" field (<span class="highlight">numPrice</span>) will automatically populate with the product's default selling price.</li>
                    <li><strong>Quantity:</strong> Enter the desired quantity in the "Quantity" field (<span class="highlight">numQuantity</span>).</li>
                    <li><strong>Price:</strong> Adjust the "Price" if necessary.</li>
                    <li><strong>Add/Update Item:</strong> Click the <strong class="text-success">Confirm</strong> button (<span class="highlight">btnConfirm_Click</span>).
                        <ul>
                            <li>If the product is already in the order details list, its quantity and price will be updated.</li>
                            <li>If it's a new product for this order, it will be added to the list.</li>
                        </ul>
                    </li>
                </ol>
                <div class="alert alert-warning" role="alert">
                    <i class="bi bi-exclamation-triangle-fill me-2"></i> <strong>Validation:</strong> Ensure Quantity and Price are greater than 0 before confirming.
                </div>

                <h3>3. Deleting Order Items</h3>
                <p>To remove a product from the order details list:</p>
                <ol>
                    <li>Select the product row in the order details data grid view.</li>
                    <li>Click the <strong class="text-danger">Delete Item</strong> button (<span class="highlight">btnDelete_Click</span>). The item will be removed from the list.</li>
                </ol>

                <h3>4. Saving the Order</h3>
                <p>Once all order details are correctly entered:</p>
                <ul>
                    <li>Click the <strong class="text-primary">Save</strong> button (<span class="highlight">btnSave_Click</span>).</li>
                    <li>The system will validate that an Employee and Customer are selected.</li>
                    <li>If it's a new order, it will be created. If it's an existing order, it will be updated.</li>
                    <li>A "Saved successfully!" message will confirm the operation, and the Order Details screen will close.</li>
                </ul>

                <h3>5. Cancelling and Closing Order Details</h3>
                <ul>
                    <li><strong class="text-secondary">Close Button (<span class="highlight">btnClose_Click</span>):</strong> Closes the Order Details screen without saving any unsaved changes.</li>
                </ul>
                <div class="alert alert-info" role="alert">
                    <i class="bi bi-info-circle me-2"></i> <strong>Note:</strong> There is a "Print" button on this screen, but its functionality is not implemented. For printing an order, please use the "Print" button on the main Orders screen.
                </div>

                <h2 id="print-order-screen" class="mt-5"><i class="bi bi-file-earmark-bar-graph-fill me-2"></i>Print Order Screen (Invoice Preview)</h2>
                <p>The Print Order screen (<span class="highlight">frmPrintOrder</span>) is dedicated to displaying a detailed, printable version of a selected sales order. It is also where you can generate a PDF copy of the invoice.</p>
                <img src="images/printorder.png" class="img-fluid mx-auto d-block" alt="Screenshot of the Print Order screen" />
                <p class="note text-center">Image: The print preview of an order, ready for printing or saving.</p>

                <h3>1. Viewing the Order Invoice</h3>
                <ul>
                    <li>Upon opening, this screen automatically loads the complete details of the order you selected from the main Orders screen.</li>
                    <li>The report displays a formatted invoice including:
                        <ul>
                            <li><strong>Company Information:</strong> Name, address, and TIN (Tax Identification Number) of the seller (retrieved from application settings).</li>
                            <li><strong>Order Date:</strong> The date the order was created.</li>
                            <li><strong>Buyer Information:</strong> Customer's name (and potentially address/TIN if available in the system).</li>
                            <li><strong>Order Items:</strong> A list of products, quantity, unit price, and subtotal for each item.</li>
                            <li><strong>Total Amount:</strong> The grand total for the entire order.</li>
                        </ul>
                    </li>
                    <li>The preview is displayed in a print-ready layout (<span class="highlight">PrintLayout</span>) with 100% zoom.</li>
                </ul>

                <h3>2. Exporting the Order as PDF</h3>
                <p>While on the Print Order screen, you can export the displayed invoice as a PDF file to save or share:</p>
                <ol>
                    <li>Click the <strong class="text-primary">Print</strong> button (<span class="highlight">btnPrint_Click</span>) located on this screen.
                        <div class="alert alert-info mt-2" role="alert">
                            <i class="bi bi-info-circle me-2"></i> <strong>Note:</strong> The "Print" button on this specific screen is designed to save the invoice as a PDF file, not to send it directly to a physical printer.
                        </div>
                    </li>
                    <li>A "Save As" dialog box will appear.</li>
                    <li>Navigate to your desired folder, and the suggested file name will be "OrderReport_[Order ID].pdf" (e.g., "OrderReport_123.pdf"). You can change the file name if needed.</li>
                    <li>Click <strong class="text-primary">Save</strong>.</li>
                    <li>A confirmation message "Order saved successfully!" will appear, indicating that the PDF file has been created and saved to your chosen location.</li>
                </ol>

                <h3>3. Direct Printing (using built-in Report Viewer controls)</h3>
                <p>To send the invoice directly to a physical printer:</p>
                <ul>
                    <li>Look for the standard printer icon (often a small printer image) within the toolbar of the Report Viewer itself (the area displaying the invoice).</li>
                    <li>Click this icon to open your system's print dialog, allowing you to select a printer and adjust print settings.</li>
                </ul>

                <h3>4. Closing the Print Order Screen</h3>
                <ul>
                    <li>Click the <strong class="text-secondary">Close</strong> button (<span class="highlight">btnClose_Click</span>) on this screen to close the print preview and return to the main Orders screen.</li>
                </ul>
            </div>
        </div>

        <div id="footer"></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script>
        $(document).ready(() => {
            $('#navbar').load('inc/navbar.html');
            $('#footer').load('inc/footer.html');
        });
    </script>
</body>

</html>